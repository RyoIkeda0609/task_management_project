# ゴール達成型タスク管理アプリ

## AI・人間共通 実装基準仕様

このドキュメントは、
本プロダクトにおける実装・修正・レビューの最終判断基準である。

迷った場合、解釈が分かれた場合、
必ず本仕様を優先する。

---

## 1. この仕様の役割

本仕様は次を保証するために存在する。

- AIが勝手に機能追加・仕様変更を行わない
- 人間がレビュー時に正誤判定できる
- 実装とドキュメントの差分が明確になる

---

## 2. MVPスコープ（絶対）

以下のみが実装対象。

- Goal
- Milestone
- Task
- 進捗自動計算
- ローカル保存
- 今日のタスク表示

---

### 禁止（重要）

以下は発見しても **絶対に追加してはいけない**。

- 通知
- クラウド同期
- ユーザー管理
- AI提案
- 自動分解
- テンプレート増加
- SNS共有

---

## 3. 機能とUseCaseの対応（実装基準）

機能はUseCaseでのみ実現される。

| ID   | 機能               |
| ---- | ------------------ |
| F-01 | ゴール作成         |
| F-02 | ゴール更新         |
| F-03 | ゴール削除         |
| F-04 | マイルストーン作成 |
| F-05 | タスク作成         |
| F-06 | タスク状態変更     |
| F-07 | 一覧取得           |
| F-08 | 今日のタスク取得   |

存在しないUseCaseは未実装とみなす。  
AIは追加してはならない。

---

## 4. 階層ルール（Domain絶対制約）

- Goal
  - Milestone
    - Task

- タスクは必ずMS配下
- MSは必ずGoal配下
- 階層の飛び越えは禁止

---

## 5. 状態ルール

Task は以下の3状態のみ：

- Todo = 0%
- Doing = 50%
- Done = 100%

これ以外を作ってはいけない。

---

## 6. 編集制限（超重要）

進捗100%になった要素は：

- Goal → 編集不可
- Milestone → 編集不可
- Task → 編集不可

閲覧のみ。

---

## 7. 進捗計算

- MS = Task平均
- Goal = MS平均

ユーザー入力は存在しない。

---

## 8. Repository保証

- 保存したら取得できる
- 削除したら取得できない
- IDは一意

---

## 9. エラー動作

| 状況            | 結果         |
| --------------- | ------------ |
| ValidationError | 変更されない |
| NotFound        | 変更されない |

---

## 10. レイヤー責務

### Domain

不変条件・ルール

### Application

UseCaseによる操作のみ

### Infrastructure

保存と取得のみ

### Presentation

表示のみ

---

## 11. AI変更制限

AIは以下を提案は可能だが、
自動変更は禁止。

- ビジネスルール追加
- データ構造変更
- 命名変更
- レイヤー変更
- 仕様外の便利機能

---

## 12. テスト成功条件

以下が通れば正しい。

- Domain
- UseCase
- Repository

---

## 13. 仕様に無い修正

必ず人間確認。
