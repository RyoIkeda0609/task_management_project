# test_strategy_master.md

テスト戦略マスタードキュメント

目的：
このプロダクトの価値である

- Goal
- Milestone
- Task

の構造
および
進捗の自動性

を将来の変更から守る。

---

# 🎯 テストの最終目的

正しく動くことではない。

**壊れたら必ず検知できること。**

---

# 🧱 防衛ライン

1. Domain（思想）
2. Application（操作）
3. Integration / UI（体験）

---

# 📊 投資比率

- Domain：60%
- Application：25%
- Integration：15%

---

---

# ===================================

# ① Domain テスト観点

# ===================================

最重要。
ここが壊れると全て壊れる。

---

## Entity 作成

### Goal

- 正常に作成できる
- 不正値なら失敗

### Milestone

- Goal が存在しない場合失敗

### Task

- Milestone が存在しない場合失敗

---

## 親子関係

- 他Goalへの紐付け変更禁止
- 不正な付け替え失敗

---

## 状態遷移

Task:

- Todo → Doing → Done はOK
- Done → Todo などの逆流が仕様外なら失敗

---

## 進捗計算

- Task完了で Milestone が更新
- Milestone更新で Goal が更新
- 件数ゼロの境界値

---

## 削除

- cascade が正しく働く

---

## 同一性

- ID が同じなら同一
- 違えば別

---

---

# ===================================

# ② Application テスト観点

# ===================================

UseCase が

- 正しい対象を取得し
- Domain を呼び
- 保存する

ことを保証。

---

## create 系

- repository.save が呼ばれる
- 生成物が返る

---

## update 系

- load → domain → save の順

---

## delete 系

- 対象が消える

---

## 例外

- 無効IDで失敗

---

---

# ===================================

# ③ Integration / Widget テスト観点

# ===================================

ユーザーが期待する流れの保証。

---

## 表示

- 作成後一覧に出る
- 完了で見た目変化

---

## 操作

- 押すと状態変わる
- 削除で消える

---

## 画面遷移

- 一覧 → 詳細

---

---

# ===================================

# ④ 回帰防止のための重要テスト

# ===================================

思想破壊を検知。

---

- Goal直下にTask作れない
- 進捗を直接変更できない
- 親跨ぎ不可

---

---

# ===================================

# ⑤ テスト品質チェック

# ===================================

AI / 人間は確認する。

- 成功だけ見てない？
- 境界値ある？
- 悪意のケースある？
- 将来の人が壊せない？

---

---

# ===================================

# ⑥ テスト作成順

# ===================================

1. Domain
2. Application
3. Integration

外から始めると抜ける。

---

---

# ✨ このドキュメントの役割

テストの漏れをゼロにする。
迷いを消す。
品質を再現可能にする。
