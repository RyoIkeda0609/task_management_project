# Quality Recovery Directive v23

目的：
バグ修正の影響で混ざった
「応急処置コード」を
設計思想に沿った正規の形へ戻す。

---

# 🎯 状態認識

- 動作は安定している
- テストも追加された

良い。

しかし：

防御が散らばっている。

---

今回の仕事は

削除  
移動  
統一

これだけ。

---

---

# ====================================

# Rule 1

# UI はデータを信用する

# ====================================

---

UI にある：

- null fallback
- 値が無い場合の代替
- サイズチェック

削除。

---

理由：
domain / application が保証する。

---

---

# ====================================

# Rule 2

# ViewModel は優しくならない

# ====================================

---

VM にある

- 「なければ〜」
- 「空なら〜」

削除 or 上位へ移動。

---

VM は
橋渡しのみ。

---

---

# ====================================

# Rule 3

# 二重防御を禁止

# ====================================

---

同じ guard が：

domain  
application  
presentation

複数に存在していないか？

---

一番内側だけに残す。

---

---

# ====================================

# Rule 4

# 新しく増えた if を全列挙

# ====================================

---

直近追加された if を確認。

全部に

「なぜここに必要？」

と説明できなければ移動。

---

---

# ====================================

# Rule 5

# エラーハンドリングの集中化

# ====================================

---

UI や VM で
個別に try/catch していないか？

---

やるなら usecase。

---

---

# ====================================

# Rule 6

# State の責務拡張

# ====================================

---

表示のための保護や整形は
state に寄せる。

---

---

# ====================================

# Rule 7

# 成功パターンの横展開

# ====================================

---

一番綺麗な画面を基準に、
他も同じ形へ。

---

---

# 🎯 完了判定

- guard の場所が説明可能
- 書き方が揃っている
- 特別扱いがない
