# Quality Recovery Protocol After Bug Fixing

目的：
緊急修正で荒れたコードを、
Clean Architecture の規律へ戻す。

---

# 🎯 重要理解

バグ修正直後に品質が落ちるのは正常。

問題はそのまま放置すること。

---

今から
「応急処置 → 正式実装」
へ昇格させる。

---

---

# ====================================

# Step 1

# 増えた if の整理

# ====================================

---

## 探すもの

最近追加された：

- null check
- 空チェック
- 分岐
- try/catch

---

## 分類する

これは

A. Domain の責務  
B. Application の責務  
C. UI都合

どれか？

---

## 修正

UI や VM にある場合は、
本来の層へ戻す。

---

---

# ====================================

# Step 2

# ViewModel の肥大除去

# ====================================

---

## 症状

- 表示保護
- fallback
- 表示用条件

が VM に入っている。

---

## 原則

VM は
UseCase 呼び出し
だけ。

---

## 修正

state か domain へ移す。

---

---

# ====================================

# Step 3

# 「念のためコード」の削除

# ====================================

---

## 見つけ方

コメントや意図が：

念のため  
一応  
保険

---

全部疑う。

---

## 判断基準

domain が保証しているなら  
削除。

---

---

# ====================================

# Step 4

# Repository 境界の再確認

# ====================================

---

UseCase から

直接 map / transform  
していないか？

---

infra の責務に戻す。

---

---

# ====================================

# Step 5

# 画面側の応急処置の排除

# ====================================

---

UI で：

- null 対応
- データ再構成

していたら即移動。

---

---

# ====================================

# Step 6

# テストの再同期

# ====================================

---

応急対応で
テストが追いついていない可能性がある。

---

- 例外
- 境界
- 不正入力

追加。

---

---

# ====================================

# Step 7

# 対称性の回復

# ====================================

---

修正した画面だけ
特別扱いになっていないか？

---

揃える。

---

---

# 🎯 完了判定

- 応急コードが消える
- 責務が元の場所に戻る
- 書き方の揺れが消える
