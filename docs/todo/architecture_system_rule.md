# FINAL ARCHITECTURE SYSTEM

最終設計統治規約 / 100点到達のための強制ルール

この文書は推奨ではない。
従わない実装は設計違反でありレビューで拒否される。

迷ったら必ずここに戻る。

---

# 🎯 このプロダクトの本質

我々は「タスク管理アプリ」を作っているのではない。

✔ 目的  
✔ マイルストーン  
✔ タスク

の構造を強制し、

ユーザーが
「なぜそれをやるのか」
を見失わない体験を提供するプロダクトである。

---

よって次を壊す変更はすべて失敗：

- 構造を弱める
- 思考を肩代わりする
- 進捗を外部から操作できる
- 責務が曖昧になる

---

# 🧱 絶対アーキテクチャ

依存方向：

Presentation → Application → Domain  
Infrastructure → Domain

逆流禁止。

---

# 👑 Domain は王様

## Domain の責務

ビジネスルールの唯一の保持者。

## Domain に入れてはいけない

- UI
- DB
- JSON
- API
- ライブラリ
- フレームワーク

## なぜ

ここが汚れると技術変更＝仕様変更になる。
破滅する。

---

## Domain が必ず守る

- 親子構造
- 状態遷移
- 進捗定義
- 作成制約

---

## 禁止

❌ 便利getter  
❌ 表示用データ  
❌ 外部都合の最適化

---

# ⚙️ Application = 操作の翻訳

## やること

- 取得
- Domain 呼び出し
- 保存

以上。

---

## やってはいけない

❌ 表示文言  
❌ 成功判定  
❌ retry  
❌ loading  
❌ 並び替え  
❌ UI向け変換

---

## 理想形

CLI から呼ばれても動く。

---

# 🗄 Infrastructure = 無知であれ

## 役割

永続化。

## 禁止

❌ 解釈  
❌ 補正  
❌ 計算  
❌ 自動変更

---

保存したものをそのまま返せ。

---

# 🎨 Presentation = 最も危険

ここは自然に太る。
放置すると全てを飲み込む。

---

## 役割

UseCase を呼び、
UI に流す。

---

## 禁止

❌ 業務判断  
❌ 成功定義  
❌ データ加工  
❌ progress 変更

---

## 理想

```dart
final result = usecase.execute(input);
return result;
```
