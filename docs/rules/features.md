# 機能一覧

## 1. ドキュメント情報

| 項目           | 内容                               |
| -------------- | ---------------------------------- |
| ドキュメント名 | 機能一覧                           |
| 最終更新日     | 2026年2月22日                      |
| 対象プロダクト | ゴール達成型タスク管理アプリ       |
| 位置づけ       | アプリが提供する全機能の定義と制約 |

---

## 2. データ階層構造

本アプリのすべての機能は、以下の **3階層構造** を前提とします。

```
Goal（ゴール）
 └─ Milestone（マイルストーン）
      └─ Task（タスク）
```

**絶対ルール：**

- タスクは必ずマイルストーン配下に存在する（ゴール直下にタスクは作れない）
- マイルストーンは必ずゴール配下に存在する
- 階層の飛び越え・横断的な移動は一切禁止

---

## 3. 機能一覧サマリー

| ID   | 機能カテゴリ       | 機能名                               | 対応UseCase                    |
| ---- | ------------------ | ------------------------------------ | ------------------------------ |
| F-01 | ゴール管理         | ゴール作成                           | CreateGoalUseCase              |
| F-02 | ゴール管理         | ゴール一覧取得                       | GetAllGoalsUseCase             |
| F-03 | ゴール管理         | ゴール詳細取得                       | GetGoalByIdUseCase             |
| F-04 | ゴール管理         | ゴール更新                           | UpdateGoalUseCase              |
| F-05 | ゴール管理         | ゴール削除（カスケード）             | DeleteGoalUseCase              |
| F-06 | ゴール管理         | ゴール検索                           | SearchGoalsUseCase             |
| F-07 | マイルストーン管理 | マイルストーン作成                   | CreateMilestoneUseCase         |
| F-08 | マイルストーン管理 | マイルストーン一覧取得（ゴール別）   | GetMilestonesByGoalIdUseCase   |
| F-09 | マイルストーン管理 | マイルストーン詳細取得               | GetMilestoneByIdUseCase        |
| F-10 | マイルストーン管理 | マイルストーン更新                   | UpdateMilestoneUseCase         |
| F-11 | マイルストーン管理 | マイルストーン削除（カスケード）     | DeleteMilestoneUseCase         |
| F-12 | タスク管理         | タスク作成                           | CreateTaskUseCase              |
| F-13 | タスク管理         | タスク一覧取得（MS別）               | GetTasksByMilestoneIdUseCase   |
| F-14 | タスク管理         | タスク詳細取得                       | GetTaskByIdUseCase             |
| F-15 | タスク管理         | タスク更新                           | UpdateTaskUseCase              |
| F-16 | タスク管理         | タスク削除                           | DeleteTaskUseCase              |
| F-17 | タスク管理         | タスク状態変更                       | ChangeTaskStatusUseCase        |
| F-18 | タスク管理         | 今日のタスク取得                     | GetAllTasksTodayUseCase        |
| F-19 | タスク管理         | ステータス別タスク取得               | GetTasksGroupedByStatusUseCase |
| F-20 | 進捗管理           | 進捗計算                             | CalculateProgressUseCase       |
| F-21 | 初回体験           | オンボーディング                     | —（Presentation層で制御）      |
| F-22 | 表示               | ホーム画面(ゴール一覧のリストビュー) | —（Presentation層で描画）      |
| F-23 | 設定               | 設定画面                             | —（Presentation層で描画）      |

---

## 4. 機能詳細

### 4.1 ゴール管理

#### F-01: ゴール作成

| 項目       | 内容                                                                     |
| ---------- | ------------------------------------------------------------------------ |
| 入力項目   | ゴール名（必須）、達成期限（必須）、カテゴリ（任意）、理由・動機（任意） |
| ゴール名   | 1〜100文字。空白のみ不可                                                 |
| 達成期限   | 本日より後の日付。時刻は00:00:00に正規化                                 |
| カテゴリ   | 固定リスト：キャリア / 学習 / 健康 / 趣味 / その他。デフォルト：キャリア |
| 理由・動機 | 0〜500文字。空文字列許容                                                 |
| ID         | UUID v4で自動生成                                                        |

#### F-02: ゴール一覧取得

| 項目       | 内容                              |
| ---------- | --------------------------------- |
| 取得対象   | 登録済みの全ゴール                |
| 表示項目   | ゴール名 / 達成期限 / 進捗率（%） |
| ソート     | 期限昇順（固定）                  |
| フィルター | 活動中 / 完了済み（進捗100%）     |

#### F-03: ゴール詳細取得

| 項目           | 内容                   |
| -------------- | ---------------------- |
| 取得方法       | ゴールIDで指定         |
| 存在しない場合 | エラー（変更されない） |

#### F-04: ゴール更新

| 項目         | 内容                                               |
| ------------ | -------------------------------------------------- |
| 編集可能項目 | ゴール名 / 達成期限 / カテゴリ / 理由・動機        |
| 制約         | **進捗100%（完了）のゴールは編集不可**（閲覧のみ） |
| 期限制約     | 本日より後の日付のみ                               |
| 完了チェック | GoalCompletionServiceで判定                        |

#### F-05: ゴール削除（カスケード）

| 項目     | 内容                                                   |
| -------- | ------------------------------------------------------ |
| 削除対象 | 指定ゴール + 配下のマイルストーン + 配下のタスクすべて |
| 削除順序 | Task → Milestone → Goal（安全な順序）                  |
| 確認     | 削除前に確認ダイアログを表示                           |
| 復元     | **不可**（ゴミ箱機能なし）                             |

#### F-06: ゴール検索

| 項目     | 内容                                       |
| -------- | ------------------------------------------ |
| 検索対象 | ゴール名 / カテゴリ / 説明                 |
| 検索方式 | キーワード部分一致（大文字小文字区別なし） |
| 備考     | MVP仕様では対象外とされていたが、実装済み  |

---

### 4.2 マイルストーン管理

#### F-07: マイルストーン作成

| 項目     | 内容                                                     |
| -------- | -------------------------------------------------------- |
| 入力項目 | マイルストーン名（必須）、詳細（任意）、達成期限（必須） |
| MS名     | 1〜100文字。空白のみ不可                                 |
| 説明     | 0〜500文字。空文字列許容                                 |
| 達成期限 | 親ゴール期限以前の日付                                   |
| 親ゴール | 必須。存在しない親ゴールIDは参照整合性エラー             |
| ID       | UUID v4で自動生成                                        |

#### F-08: マイルストーン一覧取得（ゴール別）

| 項目     | 内容                          |
| -------- | ----------------------------- |
| 取得方法 | ゴールIDで指定                |
| 表示項目 | MS名 / 達成期限 / 進捗率（%） |

#### F-09: マイルストーン詳細取得

| 項目     | 内容                   |
| -------- | ---------------------- |
| 取得方法 | マイルストーンIDで指定 |

#### F-10: マイルストーン更新

| 項目         | 内容                                           |
| ------------ | ---------------------------------------------- |
| 編集可能項目 | MS名 / 説明 / 達成期限                         |
| 制約         | **進捗100%（完了）のMSは編集不可**（閲覧のみ） |
| 完了チェック | MilestoneCompletionServiceで判定               |

#### F-11: マイルストーン削除（カスケード）

| 項目     | 内容                        |
| -------- | --------------------------- |
| 削除対象 | 指定MS + 配下のタスクすべて |
| 削除順序 | Task → Milestone            |
| 復元     | **不可**                    |

---

### 4.3 タスク管理

#### F-12: タスク作成

| 項目     | 内容                                             |
| -------- | ------------------------------------------------ |
| 入力項目 | タスク名（必須）、達成期限（必須）、説明（任意） |
| タスク名 | 1〜100文字。空白のみ不可                         |
| 達成期限 | 親マイルストーン期限以前                         |
| 説明     | 0〜500文字。空文字列許容                         |
| 初期状態 | Todo（固定）                                     |
| 親MS     | 必須。存在しない親MSIDは参照整合性エラー         |
| ID       | UUID v4で自動生成                                |

#### F-13: タスク一覧取得（MS別）

| 項目     | 内容                   |
| -------- | ---------------------- |
| 取得方法 | マイルストーンIDで指定 |

#### F-14: タスク詳細取得

| 項目     | 内容           |
| -------- | -------------- |
| 取得方法 | タスクIDで指定 |

#### F-15: タスク更新

| 項目         | 内容                                       |
| ------------ | ------------------------------------------ |
| 編集可能項目 | タスク名 / 期限 / 説明                     |
| 制約         | **Done状態のタスクは編集不可**（閲覧のみ） |
| 親MS変更     | **不可**                                   |
| 完了チェック | TaskCompletionServiceで判定                |

#### F-16: タスク削除

| 項目     | 内容                         |
| -------- | ---------------------------- |
| 削除対象 | 指定タスクのみ（子要素なし） |
| 確認     | 確認ダイアログを表示         |
| 復元     | **不可**                     |

#### F-17: タスク状態変更

| 項目   | 内容                                  |
| ------ | ------------------------------------- |
| 状態   | 3状態のみ：Todo / Doing / Done        |
| 遷移   | **循環**：Todo → Doing → Done → Todo  |
| 操作   | `cycleStatus()` による1ステップ遷移   |
| 進捗値 | Todo = 0% / Doing = 50% / Done = 100% |

**タスク状態遷移図：**

```
  ┌──────────────────────────────┐
  │                              │
  ▼                              │
 Todo ──────► Doing ──────► Done ┘
 (0%)        (50%)        (100%)
```

#### F-18: 今日のタスク取得

| 項目         | 内容                                     |
| ------------ | ---------------------------------------- |
| 取得対象     | 全ゴールを横断し、期限が本日以前のタスク |
| 過期限タスク | 期限が昨日以前のタスクも含める           |
| 0件の場合    | 「本日やるタスクはありません」と表示     |
| 表示項目     | ゴール名 / MS名 / タスク名 / 期限 / 状態 |

#### F-19: ステータス別タスク取得

| 項目     | 内容                            |
| -------- | ------------------------------- |
| 分類     | Todo / Doing / Done の3グループ |
| 付加情報 | 完了率（completionPercentage）  |

---

### 4.4 進捗管理（F-20）

#### 自動計算ルール

進捗はすべて **自動計算のみ** です。ユーザーが手動入力する項目は存在しません。

| レベル         | 計算ルール                                        |
| -------------- | ------------------------------------------------- |
| タスク         | 状態により固定値（Todo=0%, Doing=50%, Done=100%） |
| マイルストーン | 配下タスク進捗の **平均**                         |
| ゴール         | 配下マイルストーン進捗の **平均**                 |

**計算責務の所在：**

- `TaskCompletionService` — タスクの完了判定
- `MilestoneCompletionService` — MS進捗計算・完了判定
- `GoalCompletionService` — ゴール進捗計算・完了判定

これらはすべて **Domain層のサービス** として実装されています。

---

### 4.5 オンボーディング（F-21）

| 項目     | 内容                                     |
| -------- | ---------------------------------------- |
| 目的     | 思想理解とゴール作成への心理的準備       |
| 表示条件 | 初回起動時のみ（完了フラグをHiveに保存） |
| スキップ | **不可**                                 |
| 完了後   | ゴール一覧（ホーム）へ遷移               |

---

### 4.6 ホーム画面(F-22)

| 項目     | 内容                                                     |
| -------- | -------------------------------------------------------- |
| 表示形式 | ゴールの一覧を表示(ゴール名、進捗、達成予定日、カテゴリ) |
| 操作     | ゴール名タップでゴール詳細へ遷移                         |

---

### 4.7 設定（F-23）

| 項目     | 内容                                             |
| -------- | ------------------------------------------------ |
| 提供内容 | アプリ情報 / 思想・使い方説明 / お問い合わせ導線 |
| 対象外   | テーマ変更 / 通知設定                            |

---

## 5. エラー動作

| 状況                 | 結果                                           |
| -------------------- | ---------------------------------------------- |
| バリデーションエラー | 操作は実行されない。変更されない               |
| NotFound             | 操作は実行されない。変更されない               |
| 参照整合性エラー     | 操作は実行されない（例：存在しない親への作成） |

---

## 6. 将来実装しない機能（思想的に除外）

以下は、思想と矛盾するため **将来にわたって実装しません**。

- ゴール・計画の自動分解
- AIによる思考代行
- 強制的なテンプレート
- SNS共有・ランキング
- チームタスク管理
- 業務KPI管理
- 習慣トラッカー
- 自由構造ノート

---

## 7. 将来検討する機能

以下は、思想と矛盾しない範囲で将来検討します。

| フェーズ | 機能               | 条件                           |
| -------- | ------------------ | ------------------------------ |
| Phase1.5 | UI微調整           | 思想・構造に影響を与えない範囲 |
| Phase1.5 | パフォーマンス改善 | スクロール・描画最適化         |
| Phase2   | クラウド同期       | ローカルファースト設計         |
| Phase2   | アカウント機能     | 同期用途に限定                 |
| Phase2   | データバックアップ | エクスポート/インポート        |
| Phase3   | 振り返りレポート   | 行動の内省を促すなら可         |
| Phase3   | ウィジェット       | 行動を促すなら可               |
| Phase3   | 軽微な通知         | 任意・依存させない設計なら可   |
